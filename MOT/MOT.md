# MOT

## Eigen

1.　数组和矩阵的关系

> **6 Array****和Matrix之间的转换**
>
> **WHY:**什么时候该使用矩阵？什么时候又使用数组？你不能对数组执行矩阵的运算，也不能对矩阵执行数组的运算。因此当你需要做线性代数的运算，比如矩阵乘积，那你应该使用矩阵。如果你要做元素级操作，你应该使用数组。然而有时事情并不那么容易，你可能需要同时使用数组和矩阵，这时候你就需要数组和矩阵之间的互相转换了。

**矩阵和数组到底什么联系？**

## DeepSort

１．https://blog.csdn.net/hailanglin/article/details/90370375?spm=1001.2014.3001.5501

> 
>
> 1. 8个状态量（目标框中心Ｘ，目标框中心Ｙ，宽高比，高度，==**图像坐标系**==下的四个数的导数）
>
> 　2. Amax = 30 从上一次匹配到现在，长时间没有匹配上的，这里设置的阈值是30，超过这个阈值的时间没有匹配上，这个track就要被删除；
>
>  3. 目标框的匹配采用了**运动匹配**和**外观匹配**,
>
>     其中==运动匹配是马氏距离匹配==，使用卡方分布的==0.95==分位点作为阈值：nis = (d - y)^T^S^(-1)^(d-y)  其中 d为观测，ｙ为预测，Ｓ为卡尔曼滤波的结果；
>
>     ==外观匹配是采用最小余弦距离==进行匹配，解决的是在实际情况中相机运动导致的马氏距离匹配失效的情况，假设最小余弦距离记为d_cos；
>
>     最后对两个匹配的结果进行融合 c = aＸnis +(1-a)*d_cos; 文中的ａ为０;
>
>  4. ==级联匹配==: ~~TBD:~~下一篇文章已经解决了这个问题

2. https://blog.csdn.net/sgfmby1994/article/details/98517210

   > 1.  对已经存在的track分为confirmed track和unconfirm tracks(tentative);
   > 2. 针对已经confirmed track，与当前的检测结果进行级联匹配；
   > 3. unfirmed track和２中没有匹配上的track，一起组成iou_track,与还没有匹配上的结果进行IOU匹配；==IOU匹配的目的==:缓解因为表现突变或者部分遮挡导致的较大变化，这样做有可能导致一些新产生的轨迹被连接到一些旧的轨迹上，特别是tentative的的track；
   > 4. ==计算框两两之间的iou，经由１－ｉｏｕ　得到cost_matrix==
   > 5. ==track的状态好更新，~~那track的１２８维特征是否参与更新？如何更新？~~==: 匹配上的track的feature不进行更新，而是进行保存，最多保存最近与之匹配的100帧检测结果的feature.==为什么要保存100帧的feature?这100个feature是如何使用的？ＴＢＤ((xsj猜想：都参数余弦距离的计算)==
   > 6. ==feature 计算了余弦距离，形成了一个cost matrix，这个匹配的结果和cost matrix对马氏距离的匹配有什么作用？有什么影响(TBD)==
   > 7. ==为啥叫“级联匹配"==: 这个匹配操作需要从刚刚匹配成功的track循环遍历到最多已经有30次（cascade_depth)没有匹配的track; ==目的是: 给那些新鲜的track机会去先参与匹配，对那些已经有多次没有匹配上的track后参与匹配，加速这些多次没有匹配上的track的淘汰过程，因为这些多次没有匹配上的track本身已经不太准确了（~~ｘｓｊ的猜想，还没有证实~~,已经证实，正确）==
   > 8. 经历一次predict就经历一次预测，time_since_update 就＋１；
   > 9. 匹配的特征包括外观匹配和运动匹配，外观匹配是深度特征，采用最小余弦距离；运动匹配是运动状态信息，采用马氏距离；
   > 10. ==将经过马氏距离处理的矩阵cost_matrix继续由max_distance 处理，（程序中max_distance=0.2)得到处理过的cost_matrix:（ＴＢＤ）==
   > 11. ==对匹配结果进行筛选，删除两者差距较大的（ＴＢＤ）==

3. https://blog.csdn.net/sgfmby1994/article/details/98516905?spm=1001.2014.3001.5501

> 1. ==预测的结果只有(u, v, r, h)(TBD, 为啥没有速度方面的预测结果）==
> 2. ==我们可以通过卡方值来判断特征是否与类型有关。卡方值越大，说明关联越强，特征越需要保留。卡方值越小，说明越不相关，特征需要去除。Ｐ代表的是不相关的概率，１－ｐ代表的是相关的概率；https://blog.csdn.net/bitcarmanlee/article/details/52279907 矛盾(TBD)==
> 3. 当运动的不确定性很低的时候，上述的马氏距离匹配是一个合适的关联度量方法，但是在图像空间中使用kalman滤波进行运动状态估计只是一个比较粗糙的预测。特别是相机存在运动时会使得马氏距离的关联方法失效，造成ID switch的现象。==是否意味着应该在图像空间中进行预测关联匹配这些操作，而不是转到世界坐标系进行(TBD)==
> 4. 计算第i个跟踪器的最近100个成功关联的特征集与当前帧第j个检测结果的特征向量间的最小余弦距离==表明一个track的所有特征都参数计算==
> 5. ==轨迹太长，导致外观发生变化，发生变化后，再使用最小余弦距离作为度量会出问题，所以在计算距离时，轨迹中的检测数量不能太多(TBD)==
> 6. ==如果上面的距离小于指定的阈值，那么这个关联就是成功的。阈值是从单独的训练集里得到的。(TBD)==
> 7. ==*对于存在相机运动的情况，可以设置**λ**=0**。但是，马氏距离的阈值仍然生效，如果不满足第一个度量的标准，就不能进入Ｃ**ij**的融合阶段==。*
> 8. 协方差越大，代表位置的不确定性也越大，而马氏距离使用了协方差的倒数，==因此：不确定性越大，协方差越大，马氏距离越小==；
> 9. 级联匹配的核心思想就是由小到大对消失时间相同的轨迹进行匹配，这样首先保证了对最近出现的目标赋予最大的优先权 ==good==



4. https://mp.weixin.qq.com/s?__biz=MzA4MjY4NTk0NQ==&mid=2247485748&idx=1&sn=eb0344e1fd47e627e3349e1b0c1b8ada&chksm=9f80b3a2a8f73ab4dd043a6947e66d0f95b2b913cdfcc620cfa5b995958efe1bb1ba23e60100&scene=126&sessionid=1587264986&key=1392818bdbc0aa1829bb274560d74860b77843df4c0179a2cede3a831ed1c279c4603661ecb8b761c481eecb80e5232d46768e615d1e6c664b4b3ff741a8492de87f9fab89805974de8b13329daee020&ascene=1&uin=NTA4OTc5NTky&devicetype=Windows+10+x64&version=62090069&lang=zh_CN&exportkey=AeR8oQO0h9Dr/AVfL6g0VGE=&pass_ticket=R0d5J+VWKbvqy93YqUC+toKE9cFI22uY90G3JYLOU0LtrcYM2WzBJL2OxnAh0vLo

> 1. 比较的是马氏距离和卡方分布的阈值，=9.4877，如果马氏距离小于该阈值，代表成功匹配。
>
> 2. ==跟踪好坏的评估指标==：选用MOTA、MOTP、MT、ML、FN、ID swiches、FM等指标进行评估模型。
>
>    相比SORT, Deep SORT的ID Switch指标下降了45%，达到了当时的SOTA。



5. https://zhuanlan.zhihu.com/p/110107365

   > 1. 协方差参数引入了位置和速度的标准差，这两个额外参数；
   > 2. 文章认为是经验参数；
   > 3. ==速度相对于位置形状不确定性要高，长宽比尽可能变化幅度小；==

6. [https://kakack.github.io/2020/09/SORT&DeepSORT%E7%89%A9%E4%BD%93%E8%B7%9F%E8%B8%AA%E7%AE%97%E6%B3%95%E5%B0%8F%E8%AE%AE/](https://kakack.github.io/2020/09/SORT&DeepSORT物体跟踪算法小议/)

   > 概况而言就是：
   >
   > - `新的最佳估计`是基于`原最佳估计`和`已知外部影响`校正后得到的预测。
   > - `新的不确定性`是基于`原不确定性`和`外部环境的不确定性`得到的预测。

7. https://aijishu.com/a/1060000000131831

   > 1. 很详细的deep sort讲解，包括kalmanfilter的推到；
   > 2. **Q**：过程激励噪声协方差(系统过程的协方差)。该参数被用来表示状态转换矩阵与实际过程之间的误差。因为我们无法直接观测到过程信号，所以Q的取值是很难确定的。一般有两种思路：一是在某些稳定的过程可以假定它是固定的矩阵，通过寻找最优的Q值使滤波器获得更好的性能，这是调整滤波器参数的主要手段，Q一般是对角 阵，且对角线上的值很小，便于快速收敛；二是在自适应卡尔曼滤波（AKF）中Q矩阵是随时间变化的。

8. [http://giantpandacv.com/%E7%9B%AE%E6%A0%87%E6%A3%80%E6%B5%8B%E5%8F%8A%E8%B7%9F%E8%B8%AA/%E7%9B%AE%E6%A0%87%E8%B7%9F%E8%B8%AA/Deep%20Sort%E5%A4%9A%E7%9B%AE%E6%A0%87%E8%B7%9F%E8%B8%AA%E7%AE%97%E6%B3%95%E8%A7%A3%E6%9E%90%28%E4%B8%8A%29/](http://giantpandacv.com/目标检测及跟踪/目标跟踪/Deep Sort多目标跟踪算法解析(上)/)

9. https://zgcr.gitlab.io/2019/05/29/mu-biao-gen-zong-gai-nian-duo-mu-biao-gen-zong-suan-fa-sort-he-deep-sort-yuan-li/

   > 1.  ==欧氏距离，马氏距离，余弦距离==
   > 2. **余弦距离，也称为余弦相似度**，是用N维空间中两点与原点连接线段之间夹角的余弦值作为衡量两个个体间差异的大小的度量。余弦距离越大，表示夹角越小，那么两点越相似。如果余弦距离为1（最大值），那么表示两者非常相似。注意这里只能说明两点非常相似，并不一定相同。
   > 3. 余弦距离的意义：当两点夹角为零时，表示两点的各个维度的值所占的比例相同。比如（2，2，2）和（6，6，6），（1，2，3）和（3，6，9）。

10. 

11. 





